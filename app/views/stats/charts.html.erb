<%= render 'stats_menu' %>

<script type="text/javascript" charset="utf-8">
  $(function(){
    new Highcharts.Chart({
      chart: {
        renderTo: "duration7days"
      },
      title: {
        text: "7 Days - Duration"
      },
      xAxis: {
        type: "datetime"
      },
      yAxis: {
        title: {
          text: "min"
        }
      },
      tooltip: {
        formatter: function () {
          return Highcharts.dateFormat("%B %e %Y", this.x) + ': ' +
          Highcharts.numberFormat(this.y, 0) + ' min';
        }
      },
      series: [
      <% @durations7.keys.sort.each do |name| %>
      <% entries = @durations7[name] %>
        {
        name: '<%= name %>',
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= entries.first.chartdate %>,
        data: <%= entries.map(&:score) %>
        },
      <% end %>
      ],
    });

    new Highcharts.Chart({
      chart: {
        renderTo: "distance7days"
      },
      title: {
        text: "7 Days - Distance"
      },
      xAxis: {
        type: "datetime"
      },
      yAxis: {
        title: {
          text: "km"
        }
      },
      tooltip: {
        formatter: function () {
          return Highcharts.dateFormat("%B %e %Y", this.x) + ': ' +
          Highcharts.numberFormat(this.y, 0) + ' km';
        }
      },
      series: [
      <% @distances7.keys.sort.each do |name| %>
      <% entries = @distances7[name] %>
        {
        name: '<%= name %>',
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= entries.first.chartdate %>,
        data: <%= entries.map(&:score) %>
        },
      <% end %>
      ],
    });

    new Highcharts.Chart({
      chart: {
        renderTo: "duration30days"
      },
      title: {
        text: "30 Days - Duration"
      },
      xAxis: {
        type: "datetime"
      },
      yAxis: {
        title: {
          text: "min"
        }
      },
      tooltip: {
        formatter: function () {
          return Highcharts.dateFormat("%B %e %Y", this.x) + ': ' +
          Highcharts.numberFormat(this.y, 0) + ' min';
        }
      },
      series: [
      <% @durations30.keys.sort.each do |name| %>
      <% entries = @durations30[name] %>
        {
        name: '<%= name %>',
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= entries.first.chartdate %>,
        data: <%= entries.map(&:score) %>
        },
      <% end %>
      ],
    });

    new Highcharts.Chart({
      chart: {
        renderTo: "distance30days"
      },
      title: {
        text: "30 Days - Distance"
      },
      xAxis: {
        type: "datetime"
      },
      yAxis: {
        title: {
          text: "km"
        }
      },
      tooltip: {
        formatter: function () {
          return Highcharts.dateFormat("%B %e %Y", this.x) + ': ' +
          Highcharts.numberFormat(this.y, 0) + ' km';
        }
      },
      series: [
      <% @distances30.keys.sort.each do |name| %>
      <% entries = @distances30[name] %>
        {
        name: '<%= name %>',
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= entries.first.chartdate %>,
        data: <%= entries.map(&:score) %>
        },
      <% end %>
      ],
    });

    new Highcharts.Chart({
      chart: {
        renderTo: "weight"
      },
      title: {
        text: "Weight"
      },
      xAxis: {
        type: "datetime"
      },
      yAxis: {
        title: {
          text: "kg"
        }
      },
      tooltip: {
        formatter: function () {
          return Highcharts.dateFormat("%B %e %Y", this.x) + ': ' +
          Highcharts.numberFormat(this.y, 0) + ' kg';
        }
      },
      series: [
      <% @weights.keys.sort.each do |name| %>
      <% start = @weights[name].first.chartdate %>
      <% entries = fill_out(@weights[name]) %>
        {
        name: '<%= name %>',
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= start %>,
        data: <%= entries %>
        },
      <% end %>
      ],
    });
  });
</script>

<div id="duration7days" style="width:560px; height:300px;"></div>

<div id="distance7days" style="width:560px; height:300px;"></div>

<div id="duration30days" style="width:560px; height:300px;"></div>

<div id="distance30days" style="width:560px; height:300px;"></div>

<div id="weight" style="width:560px; height:300px;"></div>

<%= form_tag posts_path, :method => :get do %>
  <%= submit_tag t('helpers.submit.calendar'), :class => :cancel %>
<% end %>

<div class="clear"></div>
